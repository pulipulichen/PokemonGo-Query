<!DOCTYPE html>
<html>
  <head>
    <title>out-of-ranking-ids</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
	textarea {
		display: block;
		width: 100%;
    height: 20vh;
    min-height: 5em;
	}
  
  th {
    vertical-align: top;
  }
	</style>
  </head>
  <body>
    <h1>in-ranking-ids-exclude 
      <a href="https://docs.google.com/spreadsheets/d/1t87-wOouod1RPUoBDsF4HN1uYsLsQyUm8Hxh1Xfxzyw/edit#gid=242478575" target="_blank">(搜尋指令)</a>
    </h1>
    
    <table width="100%">
      <tbody>
        <tr>
          <th>條件</th>
          <th>輸入</th>
          <th>輸出</th>
        </tr>
        <tr>
          <th>!1*</th>
          <td><textarea id="input1" onfocus="this.select()" outputid="#output1"></textarea></td>
          <td><textarea id="output1" onfocus="this.select()"></textarea></td>
        </tr>
        <tr>
          <th>!1*&!2*</th>
          <td><textarea id="input12" onfocus="this.select()" outputid="#output12"></textarea></td>
          <td><textarea id="output12" onfocus="this.select()"></textarea></td>
        </tr>
        <tr>
          <th>!2*</th>
          <td><textarea id="input2" onfocus="this.select()" outputid="#output2"></textarea></td>
          <td><textarea id="output2" onfocus="this.select()"></textarea></td>
        </tr>
        <tr>
          <th>!3*</th>
          <td><textarea id="input3" onfocus="this.select()" outputid="#output3"></textarea></td>
          <td><textarea id="output3" onfocus="this.select()"></textarea></td>
        </tr>
        <!--
        <tr>
          <th colspan="2">排名中，不需交換，檢查非PvP即可刪除 (近距離)</th>
        </tr>
        <tr>
          <td colspan="2"><textarea id="output2" onfocus="this.select()"></textarea></td>
        </tr>
        -->
      </tbody>
    </table>
    
    
    
    
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>
      let prefix = "&距離0-10&!交換&!e&!c&!暗影&!淨化&!傳說的寶可夢&!異色&!亮晶晶&"
      let prefixNoDist = "!4*&距離0-10&!交換&!e&!c&!暗影&!淨化&!傳說的寶可夢&!異色&!亮晶晶&"
      
      let inputList = ['1', '12', '2', '3']
      let inputIVList = ['!1*&!4*', '!1*&!2*&!4*', '!2*&!4*', '!3*&!4*']
      inputList.forEach((id, i) => {
        $('#input' + id).change(function () {
          let ids = $(this).val().trim().split('\n').join(',').split(',').filter( (value, index, self) => { 
            if (value.trim() === '') {
              return false
            }
            return self.indexOf(value) === index;
          });

          let query = ids.join(',')
          query = inputIVList[i] + prefix + query
          //let queryNoDist = prefixNoDist + query
          //console.log(query)
          console.log($(this).attr('outputid'))
          $($(this).attr('outputid')).val(query)
        })
      })
    
	</script>
  </body>
</html>
